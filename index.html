<!DOCTYPE html>
<html lang="en">
<head>
  <title>Content Security Policy</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
  <link rel="stylesheet" href="shower/themes/ribbon/styles/styles.css">
  <link rel="stylesheet" href="styles.css">
  <style>
    .shower {
      --slide-ratio: calc(16 / 9);
    }
  </style>
</head>

<body class="shower list">

<header class="caption">
  <h1>Content Security Policy</h1>
  <p>Dmitriy Kovalev</p>
</header>

<section class="slide">
  <h1>CSP – охранник у двери приложения</h1>
  <img id="intro-image" src="pictures/you-shall-not-pass.png" alt="Gandalf">
</section>

<section class="slide">
  <h2>CSP</h2>
  <p>
    <strong>Content Security Policy</strong> is a computer security standard introduced to prevent cross-site scripting
    (XSS), clickjacking and other code injection attacks resulting from execution of malicious content in the trusted
    web page context.
  </p>
  <img id="definition-image" src="pictures/wtf.png" alt="WTF?">
</section>

<section class="slide">
  <h1>А попроще?</h1>
  <p>
    <strong>CSP</strong> – штука, позволяющая сформировать белый список доверенных ресурсов, которые могут загружаться на веб-странице.
  </p>

  <br>

  <figure>
    <blockquote>
      <p>Всё, что не разрешено – запрещено.</p>
    </blockquote>
    <figcaption>Капитан Очевидность</figcaption>
  </figure>
</section>

<section class="slide">
  <h1>А на картинке?</h1>
  <img src="pictures/schema.png" alt="Schema">
</section>

<section class="slide">
  <h1>Что по поддержке браузерами?</h1>

  <img src="pictures/browser-support-level1.png" alt="CSP Level 1">
</section>

<section class="slide">
  <h1>CSP Level 2</h1>

  <img src="pictures/browser-support-level2.png" alt="CSP Level 1">
</section>

<section class="slide">
  <h1>Ближе к делу</h1>

  <p>
    <code>Content-Security-Policy</code> – общий заголовок
  </p>
  <p>
    <code>Content-Security-Policy-Report-Only</code> – режим сообщения о нарушениях
  </p>
</section>

<section class="slide">
  <h1>Огласите весь список, пожалуйста</h1>

  <ul class="list-3col">
    <li>default-src</li>
    <li>script-src</li>
    <li>style-src</li>
    <li>img-src</li>
    <li>connect-src</li>
    <li>font-src</li>
    <li>object-src</li>
    <li>media-src</li>
    <li>frame-src <span class="badge-mark badge-mark_red">Deprecated</span></li>
    <li>child-src</li>
    <li>sandbox</li>
    <li>report-uri</li>
    <li>form-action <span class="badge-mark badge-mark_green">Level 2</span></li>
    <li>frame-ancestors <span class="badge-mark badge-mark_green">Level 2</span></li>
    <li>plugin-types <span class="badge-mark badge-mark_green">Level 2</span></li>
  </ul>
</section>

<section class="slide">
  <h1>Возможные значения -src директив</h1>

  <table>
    <tr>
      <th>Source</th>
      <td><code>https://google.com</code> <code>google.com:443</code> <code>https:</code> <code>data:</code></td>
    </tr>
    <tr>
      <th>Keyword</th>
      <td><code>*</code> <code>'none'</code> <code>'self'</code> <code>'unsafe-inline'</code> <code>'unsafe-eval'</code></td>
    </tr>
    <tr>
      <th>Hash</th>
      <td><code>'sha256-...'</code> <code>'nonce-...'</code></td>
    </tr>
  </table>

  <p>
    <a href="https://www.w3.org/TR/CSP2/#source_list">https://www.w3.org/TR/CSP2/#source_list</a>
  </p>
</section>

<section class="slide">
  <h1>default-src</h1>

  <p>Задаёт стандартные политики, которые будут использованы в случае отсутствия следующих директив:</p>

  <ul class="list-2col">
    <li>child-src</li>
    <li>connect-src</li>
    <li>font-src</li>
    <li>img-src</li>
    <li>media-src</li>
    <li>object-src</li>
    <li>script-src</li>
    <li>style-src</li>
  </ul>
</section>

<section class="slide">
  <h1>script-src</h1>

  <p>Контроль исполняемых скриптов</p>

  <p>
    <div><code>script-src 'self' https://google.com</code></div>
    <div><code>script-src 'unsafe-inline' *.example.com</code></div>
  </p>

  <p>
    <div><code>'unsafe-inline'</code> – разрешение инлайн script</div>
    <div><code>'unsafe-eval'</code> – разрешение функции eval</div>
  </p>
</section>

<div class="progress"></div>

<script src="shower/shower.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>
